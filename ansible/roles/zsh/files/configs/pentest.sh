RECON_DIR="$HOME/code/recon"

_create_recon_dir() {
  local recon_home="$RECON_DIR/$1"
  [[ ! -d $recon_home ]] && mkdir -p $recon_home
  echo $recon_home
}

dnsscan() {
  local recon_home="$(_create_recon_dir $1)"
  local file_name="subdomains-$(echo $1|sed 's/\./-/g').txt"
  local output_path="$recon_home/$file_name"

  [[ -z "$1" ]] && echo "Usage: $0 <domain>" && return 1

  subfinder -d $1 -o $output_path
}

listhosts() {
  local address=$(ifconfig | grep 'inet ' | grep -v '127.0.0.1' | awk '{print $2}'| cut -d '.' -f 1-3)
  local network="$address.0/24"
  sudo nmap -sP -PE -PP -PS21,23,80,3389 -PA80,23,443,3389 -PU53 -T4 $network
}

httpstatus() {
  [[ -z "$1" ]] && echo "Usage: $0 <url>" && return 1

  curl -s -o /dev/null -w "%{http_code} %{url_effective}\n" $1
}
